/*
 * jQuery html2Picture
 * Version 0.1 (@edouardkombo / breezeframework.com)
 * https://github.com/edouardkombo/jquery-html2Picture
 *
 * Capture img and videos in html dom with javascript.
 *
 * Copyright (c) 2014 Edouard Kombo (@edouardkombo / breezeframework.com)
 * Dual licensed under the MIT and GPL licenses.
*/
(function(e){e.fn.html2Picture=function(t){var n={type:"photo",pictureName:e.now(),pictureFormat:"jpeg",showCanvas:false,width:"",height:"",quality:0,callback:"null"};if(t){e.extend(n,t)}this.each(function(){function f(){if(n.type!=="video"){o.drawImage(u,0,0,s.width,s.height)}else{o.drawImage(i[0],0,0,s.width,s.height)}a=s[0].toDataURL("image/"+n.pictureFormat,n.quality);if(e.isFunction(n.callback)){n.callback.call(this,{url:a,name:n.pictureName,extension:n.pictureFormat,fullPictureName:n.pictureName+"."+n.pictureFormat})}}var t=e(this);var r=["jpeg","jpg","png","gif"];var i=e(t);var s=e("canvas").length>0?e("canvas"):e("<canvas>").attr({id:"canvas"}).appendTo("body");var o=s[0].getContext("2d");var u=new Image;u.src=n.type==="photo"?i.attr("src"):"";var a="";if(e.inArray(n.pictureFormat,r)!==-1){n.pictureFormat=n.pictureFormat==="jpg"?"jpeg":n.pictureFormat;if(n.width===""&&n.height===""){e("canvas").attr({width:i.width(),height:i.height()});s.width=i.width();s.height=i.height()}else{i.css("width",n.width);i.css("height",n.height);e("canvas").attr({width:n.width,height:n.height});s.width=n.width;s.height=n.height}if(u.src===window.location.href){if(n.type==="html"){}else{f()}}else{u.onload=function(){f()}}if(n.showCanvas===true){e("canvas").show()}}else{alert('File "'+n.pictureFormat+'" chosen for html2picture is not valid!')}});return this}})(jQuery)